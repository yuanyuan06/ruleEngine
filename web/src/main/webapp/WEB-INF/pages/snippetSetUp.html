<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <head>
        <link type="text/css" rel="stylesheet" th:href="@{/css/common.css}" />
        <script th:src="@{/js/jquery-3.2.1.min.js}"></script>
    </head>
    <!--<script th:src="@{/js/sundries.js}"></script>-->

    <script type="text/javascript">

        function getScriptNum(){
            var str = $("#groovyScript").val();
            if(str.length > 0){
                var mm = str.match(/def[\s]+(\S*)\(/);
                str = mm && mm[1] ?  mm[1]:null;
            }

            if(!str){
                alert("请书写规范脚本");
            }else{
                $("#doc_num").val(str);
            }
        }


        $(function(){
            $("#saveSnippet").on("click", function(){


                var val = $("#doc_num").val();
                var val2 = $("#groovyScript").val();


                $.post( "/engine/saveScript.htm",
                        {
                            "docNum": val,
                            "groovyScript": val2
                        },
                        function(result){
                            console.log(result.resultCode + ":::" + result.msg)
                        },
                        "json"
                        );
            });
        });


    </script>
</head>
<body>

<div>
    <em>groovy脚本编写</em><br>
    <hr/>
    <input id="doc_num" class="common_btn" disabled></input> 编码<br>
    <textarea id="groovyScript" class="common_textarea"></textarea>
    <br>
    <input id="generateNum" type="button" value="获取编码" onclick="getScriptNum()">
    &nbsp;
    <button type="button" class="common_btn" id="saveSnippet">保存</button>
</div>

</body>
</html>